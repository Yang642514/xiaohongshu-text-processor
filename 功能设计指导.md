

当前实现说明（v0.1.0）

一、文本处理与解析
- 分论点识别：支持中文序号（“论点一/二/三…”、“第1点”）、数字序号（“1.”、“1、”）、符号列举（“-”、“•”等）作为分论点起始标记；每个分论点拆分为“分论点标题”和“分论点内容”。
- 标点规范化：英文标点自动替换为中文标点（，。！？：；“”‘’等）。
- 排版规则：每段约 45 个中文字符自动折行（`max_chars_per_line=45`）；段落不限制行数（`max_lines_per_paragraph=0`），保持原有段落结构与顺序。

二、Excel 写入（保持模板样式不变）
- 表头定位：扫描模板前 10 行以寻找包含所需列的表头行。
- 必需列：`页面`、`文本_1`、`文本_2`、`页面比例`（若存在则自动写入）。
- 写入规则（每个分论点一行）：
  - `页面`：按序生成页面名，如“分论点一页面”、“分论点二页面”…；超过“二十”后使用数字序号。
  - `文本_1`：分论点标题。
  - `文本_2`：分论点内容（已按规则自动折行与中文标点规范）。
  - `页面比例`：若模板存在该列，自动写入全局默认比例 `3:4`（不再需要或显示“页面比例列名”的设置）。
- 输出文件名：`标题_时间戳.xlsx`；如无标题则使用 `输出_时间戳.xlsx`。

三、压缩打包
- 在设置的“压缩包目录”生成 ZIP；可选地删除生成的 Excel（`delete_excel_after_zip=true` 时仅保留 ZIP）。
- 压缩包命名：`标题_时间戳.zip`（与 Excel 同名）。

四、设置项（界面可配置）
- 模板路径：`template_excel_path`。
- 压缩包目录：`zip_output_dir`（所有输出均写入此目录）。
- 列映射：`page_column`、`point_title_column`、`point_content_column`（需与模板表头一致）。
- 全局页面比例：`page_ratio`（默认 `3:4`，用于写入 `页面比例` 列的值；不再支持“页面比例列名”设置）。
- 文本排版：`max_chars_per_line=45`、`max_lines_per_paragraph=0`。

五、错误处理与日志
- 模板校验：前 10 行找不到必需列会报错并弹窗提示；日志记录具体缺失列与表头行信息。
- 运行日志：位于 `logs/run_*.log`，包含启动、解析、写入、打包、错误等详细记录。

六、使用流程（简要）
- 在主界面粘贴文案 → 点击“开始处理”生成可编辑的处理模板文本 → 点击“写入并打包” → 在压缩包目录查看生成的 ZIP（必要时打开 Excel 验证行内容）。

七、验证要点
- 模板首行包含 `页面/文本_1/文本_2`（可选：`页面比例`）。
- 生成的 Excel 中，每个分论点占一行，`页面` 为“分论点×页面”，`文本_1` 为标题，`文本_2` 为内容；若存在 `页面比例` 列则为 `3:4`。
- ZIP 命名包含标题和时间戳，且在设置的目录中生成；如启用删除 Excel，仅保留 ZIP。
- 日志记录了程序的运行过程，包括启动、解析、写入、打包、错误等。